{% extends "hidp/base.html" %}
{% load i18n %}

{% block title %}{% translate 'Sign up' %}{% endblock %}

{% block body %}
  <h1>{% translate 'Create a new account' %}</h1>

  {% if oidc_error_message %}
  <ul>
    <li>
      {{ oidc_error_message }}
    </li>
  </ul>
  {% endif %}

  {% if not can_register %}
  <p>
    {% blocktranslate %}You are currently logged in as {{ user }}.{% endblocktranslate %}
    {% translate 'To create a new account, please log out first.' %}
  </p>

  <form action="{{ logout_url }}" method="post">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ logout_next_url }}">
    <p><button type="submit">{% translate 'Log out' %}</button></p>
  </form>

  <p>
    {% blocktranslate trimmed %}
    Alternatively, you can <a href="{{ next }}">continue using your current account</a>.
    {% endblocktranslate %}
  </p>

  {% else %}
  <form method="post">
    {% csrf_token %}
    {{ form }}
    <button type="submit">{% translate 'Sign up' %}</button>
  </form>

  {% if oidc_login_providers %}
  <hr>

  <h1>{% translate 'Sign up using a trusted service' %}</h1>

  {% for item in oidc_login_providers %}
  <form action="{{ item.url }}" method="POST">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ next }}">
    <button type="submit">
      {% blocktranslate trimmed with provider=item.provider.name %}
      Sign up using {{ provider }}
      {% endblocktranslate %}
    </button>
  </form>

  {% endfor %}
  {% endif %}

  <hr>

  <p>
    {% translate 'Already have an account?' %}
    <a href="{{ login_url }}">{% translate 'Log in' %}</a>
  </p>
  {% endif %}
{% endblock %}
